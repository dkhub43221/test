local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "Gun Purchaser",
    LoadingTitle = "Gun Purchaser",
    LoadingSubtitle = "by YourName",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "GunPurchaserConfig",
        FileName = "UserConfig"
    },
    Discord = {
        Enabled = false,
        Invite = "your-invite-code",
        RememberJoins = true
    }
})

local GeneralTab = Window:CreateTab("General", 4483362458)

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer

local function getGunList()
    local guns = {}
    local folder = workspace:FindFirstChild("GUNS") or ReplicatedStorage:FindFirstChild("GUNS")
    if not folder then return guns end

    for _, gun in ipairs(folder:GetChildren()) do
        if gun:IsA("Model") or gun:IsA("BasePart") then
            table.insert(guns, gun.Name)
        end
    end

    return guns
end

local function FirePrompt(prompt)
    if typeof(fireproximityprompt) == "function" then
        fireproximityprompt(prompt)
    else
        prompt:InputHoldBegin()
        task.wait(prompt.HoldDuration or 0)
        prompt:InputHoldEnd()
    end
end

local function purchaseGun(gunName)
    if type(gunName) ~= "string" then return false end

    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")

    local folder = workspace:FindFirstChild("GUNS") or ReplicatedStorage:FindFirstChild("GUNS")
    if not folder then return false end

    local gun = folder:FindFirstChild(gunName)
    if not gun then return false end

    if gun:IsA("Model") and gun.PrimaryPart then
        hrp.CFrame = gun.PrimaryPart.CFrame * CFrame.new(0, 0, -2)
    elseif gun:IsA("BasePart") then
        hrp.CFrame = gun.CFrame * CFrame.new(0, 0, -2)
    end

    task.wait(0.3)

    local prompt = gun:FindFirstChildWhichIsA("ProximityPrompt", true)
    if prompt then
        FirePrompt(prompt)
        return true
    end

    local click = gun:FindFirstChildWhichIsA("ClickDetector", true)
    if click and fireclickdetector then
        fireclickdetector(click)
        return true
    end

    local remotes = ReplicatedStorage:FindFirstChild("Remotes")
    if remotes then
        for _, r in ipairs(remotes:GetChildren()) do
            if r:IsA("RemoteEvent") then
                pcall(function()
                    r:FireServer(gunName)
                end)
            end
        end
        return true
    end

    return false
end

local selectedGun

GeneralTab:CreateDropdown({
    Name = "Select Gun",
    Options = getGunList(),
    CurrentOption = {},
    Callback = function(option)
        selectedGun = option[1]
    end
})

GeneralTab:CreateButton({
    Name = "Buy Selected Gun",
    Callback = function()
        if not selectedGun then
            Rayfield:Notify({
                Title = "Error",
                Content = "Select a gun first",
                Duration = 2
            })
            return
        end

        local success = purchaseGun(selectedGun)

        Rayfield:Notify({
            Title = success and "Success" or "Failed",
            Content = success and ("Bought " .. selectedGun) or "Purchase failed",
            Duration = 2
        })
    end
})
